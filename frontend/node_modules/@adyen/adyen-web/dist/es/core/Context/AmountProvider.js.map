{"version":3,"file":"AmountProvider.js","sources":["../../../../src/core/Context/AmountProvider.tsx"],"sourcesContent":["import { h, createContext, Fragment } from 'preact';\nimport { useContext, useEffect, useImperativeHandle, useMemo, useState } from 'preact/hooks';\nimport type { ComponentChildren, RefObject } from 'preact';\nimport type { PaymentAmount } from '../../types';\n\ninterface AmountContextValue {\n    amount?: PaymentAmount;\n    secondaryAmount?: PaymentAmount;\n}\n\nexport interface AmountProviderProps {\n    amount?: PaymentAmount;\n    secondaryAmount?: PaymentAmount;\n    providerRef: RefObject<AmountProviderRef>;\n    children: ComponentChildren;\n}\n\nexport interface AmountProviderRef {\n    update(newAmount: PaymentAmount, newSecondaryAmount?: PaymentAmount): void;\n}\n\nconst AmountContext = createContext<AmountContextValue | undefined>(undefined);\n\nconst useAmount = (): { amount: PaymentAmount | undefined; isZeroAuth: boolean } => {\n    const context = useContext(AmountContext);\n    if (!context) {\n        throw new Error('useAmount must be used within an AmountProvider');\n    }\n\n    return {\n        amount: context.amount,\n        isZeroAuth: context.amount?.value === 0\n    };\n};\n\nconst useSecondaryAmount = (): { secondaryAmount: PaymentAmount | undefined } => {\n    const context = useContext(AmountContext);\n    if (!context) {\n        throw new Error('useAmount must be used within an AmountProvider');\n    }\n    return { secondaryAmount: context.secondaryAmount };\n};\n\nconst AmountProvider = ({ amount, secondaryAmount, providerRef, children }: AmountProviderProps) => {\n    const context = useContext(AmountContext);\n\n    const [updatedAmount, setUpdatedAmount] = useState<PaymentAmount>(amount);\n    const [updatedSecondaryAmount, setUpdatedSecondaryAmount] = useState<PaymentAmount | undefined>(secondaryAmount);\n\n    useEffect(() => {\n        setUpdatedAmount(amount);\n    }, [amount]);\n\n    useImperativeHandle(providerRef, () => ({\n        update: (newAmount: PaymentAmount, newSecondaryAmount?: PaymentAmount) => {\n            setUpdatedAmount(newAmount);\n            setUpdatedSecondaryAmount(newSecondaryAmount);\n        }\n    }));\n\n    const contextValue = useMemo(() => ({ amount: updatedAmount, secondaryAmount: updatedSecondaryAmount }), [updatedAmount, updatedSecondaryAmount]);\n\n    if (context) {\n        return <Fragment>{children}</Fragment>;\n    }\n\n    return <AmountContext.Provider value={contextValue}>{children}</AmountContext.Provider>;\n};\n\nexport { AmountProvider, useAmount, useSecondaryAmount };\n"],"names":["AmountContext","createContext","undefined","useAmount","context","useContext","Error","amount","isZeroAuth","value","useSecondaryAmount","secondaryAmount","AmountProvider","providerRef","children","updatedAmount","setUpdatedAmount","useState","updatedSecondaryAmount","setUpdatedSecondaryAmount","useEffect","useImperativeHandle","update","newAmount","newSecondaryAmount","contextValue","useMemo","h","Fragment","Provider"],"mappings":"gPAqBA,MAAMA,EAAgBC,OAA8CC,GAE9DC,EAAY,KACd,MAAMC,EAAUC,EAAWL,GAC3B,IAAKI,EACD,MAAM,IAAIE,MAAM,mDAGpB,MAAO,CACHC,OAAQH,EAAQG,OAChBC,WAAsC,IAA1BJ,EAAQG,QAAQE,QAI9BC,EAAqB,KACvB,MAAMN,EAAUC,EAAWL,GAC3B,IAAKI,EACD,MAAM,IAAIE,MAAM,mDAEpB,MAAO,CAAEK,gBAAiBP,EAAQO,kBAGhCC,EAAiB,EAAGL,SAAQI,kBAAiBE,cAAaC,eAC5D,MAAMV,EAAUC,EAAWL,IAEpBe,EAAeC,GAAoBC,EAAwBV,IAC3DW,EAAwBC,GAA6BF,EAAoCN,GAEhGS,EAAU,KACNJ,EAAiBT,IAClB,CAACA,IAEJc,EAAoBR,EAAa,KAAA,CAC7BS,OAAQ,CAACC,EAA0BC,KAC/BR,EAAiBO,GACjBJ,EAA0BK,OAIlC,MAAMC,EAAeC,EAAQ,KAAA,CAASnB,OAAQQ,EAAeJ,gBAAiBO,IAA2B,CAACH,EAAeG,IAEzH,OAAId,EACOuB,EAACC,EAAAA,KAAUd,GAGfa,EAAC3B,EAAc6B,SAAQ,CAACpB,MAAOgB,GAAeX"}