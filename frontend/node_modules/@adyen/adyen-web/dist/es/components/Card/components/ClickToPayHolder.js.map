{"version":3,"file":"ClickToPayHolder.js","sources":["../../../../../src/components/Card/components/ClickToPayHolder.tsx"],"sourcesContent":["import { Fragment, h } from 'preact';\nimport { useCallback, useEffect, useState } from 'preact/hooks';\nimport useClickToPayContext from '../../internal/ClickToPay/context/useClickToPayContext';\nimport { CtpState } from '../../internal/ClickToPay/services/ClickToPayService';\nimport ClickToPayComponent from '../../internal/ClickToPay';\nimport ContentSeparator from '../../internal/ContentSeparator';\nimport Button from '../../internal/Button';\nimport { useCoreContext } from '../../../core/Context/CoreProvider';\n\ntype ClickToPayWrapperProps = {\n    children(isCardPrimaryInput?: boolean): h.JSX.Element;\n};\n\nconst ClickToPayHolder = ({ children }: ClickToPayWrapperProps) => {\n    const { i18n } = useCoreContext();\n    const [isCardInputVisible, setIsCardInputVisible] = useState<boolean>(null);\n    const { ctpState, isCtpPrimaryPaymentMethod, setIsCtpPrimaryPaymentMethod, status } = useClickToPayContext();\n\n    const areFieldsNotSet = isCardInputVisible === null && isCtpPrimaryPaymentMethod === null;\n\n    useEffect(() => {\n        if (areFieldsNotSet) {\n            if (ctpState === CtpState.ShopperIdentified || ctpState === CtpState.Ready) {\n                setIsCardInputVisible(false);\n                setIsCtpPrimaryPaymentMethod(true);\n                return;\n            }\n            if (ctpState === CtpState.NotAvailable) {\n                setIsCardInputVisible(true);\n                setIsCtpPrimaryPaymentMethod(false);\n            }\n        }\n    }, [ctpState, areFieldsNotSet]);\n\n    const handleOnShowCardButtonClick = useCallback(() => {\n        setIsCardInputVisible(true);\n        setIsCtpPrimaryPaymentMethod(false);\n    }, []);\n\n    const handleButtonKeyDown = useCallback(\n        (event: KeyboardEvent) => {\n            if (event.key === 'Enter') {\n                void handleOnShowCardButtonClick();\n            }\n        },\n        [handleOnShowCardButtonClick]\n    );\n\n    if (ctpState === CtpState.NotAvailable) {\n        return children();\n    }\n\n    if (ctpState === CtpState.Loading || ctpState === CtpState.ShopperIdentified) {\n        return <ClickToPayComponent />;\n    }\n\n    return (\n        <Fragment>\n            <ClickToPayComponent onDisplayCardComponent={handleOnShowCardButtonClick} />\n\n            <ContentSeparator classNames={['adyen-checkout-ctp__separator']} label={i18n.get('ctp.separatorText')} />\n\n            {isCardInputVisible ? (\n                children(!isCtpPrimaryPaymentMethod)\n            ) : (\n                <Button\n                    variant=\"secondary\"\n                    disabled={status === 'loading'}\n                    label={i18n.get('ctp.manualCardEntry')}\n                    onClick={handleOnShowCardButtonClick}\n                    onKeyDown={handleButtonKeyDown}\n                />\n            )}\n        </Fragment>\n    );\n};\n\nexport default ClickToPayHolder;\n"],"names":["ClickToPayHolder","children","i18n","useCoreContext","isCardInputVisible","setIsCardInputVisible","useState","ctpState","isCtpPrimaryPaymentMethod","setIsCtpPrimaryPaymentMethod","status","useClickToPayContext","areFieldsNotSet","useEffect","CtpState","ShopperIdentified","Ready","NotAvailable","handleOnShowCardButtonClick","useCallback","handleButtonKeyDown","event","key","Loading","h","ClickToPayComponent","Fragment","onDisplayCardComponent","ContentSeparator","classNames","label","get","Button","variant","disabled","onClick","onKeyDown"],"mappings":"mlBAaA,MAAMA,EAAmB,EAAGC,eACxB,MAAMC,KAAEA,GAASC,KACVC,EAAoBC,GAAyBC,EAAkB,OAChEC,SAAEA,EAAQC,0BAAEA,EAAyBC,6BAAEA,EAA4BC,OAAEA,GAAWC,IAEhFC,EAAyC,OAAvBR,GAA6D,OAA9BI,EAEvDK,EAAU,KACN,GAAID,EAAiB,CACjB,GAAIL,IAAaO,EAASC,mBAAqBR,IAAaO,EAASE,MAGjE,OAFAX,GAAsB,QACtBI,GAA6B,GAG7BF,IAAaO,EAASG,eACtBZ,GAAsB,GACtBI,GAA6B,GAErC,GACD,CAACF,EAAUK,IAEd,MAAMM,EAA8BC,EAAY,KAC5Cd,GAAsB,GACtBI,GAA6B,IAC9B,IAEGW,EAAsBD,EACvBE,IACqB,UAAdA,EAAMC,KACDJ,KAGb,CAACA,IAGL,OAAIX,IAAaO,EAASG,aACfhB,IAGPM,IAAaO,EAASS,SAAWhB,IAAaO,EAASC,kBAChDS,EAACC,EAAAA,MAIRD,EAACE,OACGF,EAACC,EAAAA,CAAoBE,uBAAwBT,IAE7CM,EAACI,EAAAA,CAAiBC,WAAY,CAAC,iCAAkCC,MAAO5B,EAAK6B,IAAI,uBAEhF3B,EACGH,GAAUO,GAEVgB,EAACQ,EAAAA,CACGC,QAAQ,YACRC,SAAqB,YAAXxB,EACVoB,MAAO5B,EAAK6B,IAAI,uBAChBI,QAASjB,EACTkB,UAAWhB"}