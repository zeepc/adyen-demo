{"version":3,"file":"PreAuthorizedDebitCanada.js","sources":["../../../../src/components/PreAuthorizedDebitCanada/PreAuthorizedDebitCanada.tsx"],"sourcesContent":["import { h, Fragment } from 'preact';\nimport UIElement from '../internal/UIElement/UIElement';\nimport { TxVariants } from '../tx-variants';\nimport PreAuthorizedDebitCanadaComponent from './components/PreAuthorizedDebitCanadaComponent';\nimport { SettlementInfo } from './components/SettlementInfo';\nimport RedirectButton from '../internal/RedirectButton';\nimport { payAmountLabel } from '../internal/PayButton/utils';\n\nimport type { PreAuthorizedDebitCanadaConfiguration } from './types';\n\nexport class PreAuthorizedDebitCanada extends UIElement<PreAuthorizedDebitCanadaConfiguration> {\n    public static type = TxVariants.eft_directdebit_CA;\n\n    public override formatData() {\n        const recurringPayment = !!this.props.storedPaymentMethodId;\n\n        if (recurringPayment) {\n            return {\n                paymentMethod: {\n                    type: PreAuthorizedDebitCanada.type,\n                    storedPaymentMethodId: this.props.storedPaymentMethodId\n                }\n            };\n        }\n\n        return {\n            paymentMethod: {\n                type: PreAuthorizedDebitCanada.type,\n                ownerName: this.state.data.ownerName,\n                bankAccountNumber: this.state.data.bankAccountNumber,\n                bankCode: this.state.data.bankCode,\n                bankLocationId: this.state.data.bankLocationId\n            },\n            ...(this.state.storePaymentMethod && { storePaymentMethod: this.state.storePaymentMethod })\n        };\n    }\n\n    public override formatProps(props: PreAuthorizedDebitCanadaConfiguration): PreAuthorizedDebitCanadaConfiguration {\n        return {\n            enableStoreDetails: props.session?.configuration?.enableStoreDetails ?? props.enableStoreDetails,\n            ...props\n        };\n    }\n\n    public override get isValid(): boolean {\n        if (this.props.storedPaymentMethodId) {\n            return true;\n        }\n\n        return !!this.state.isValid;\n    }\n\n    public override get displayName(): string {\n        if (this.props.storedPaymentMethodId && this.props.lastFour) {\n            return `•••• ${this.props.lastFour}`;\n        }\n\n        return this.props.name;\n    }\n\n    public override get additionalInfo(): string {\n        return this.props.storedPaymentMethodId ? this.props.label : '';\n    }\n\n    protected override componentToRender(): h.JSX.Element {\n        return this.props.storedPaymentMethodId ? (\n            <Fragment>\n                <SettlementInfo />\n                <RedirectButton\n                    showPayButton={this.props.showPayButton}\n                    icon={this.resources?.getImage({ imageFolder: 'components/' })(`bento_lock`)}\n                    label={payAmountLabel(this.props.i18n, this.props.amount)}\n                    name={this.displayName}\n                    payButton={this.payButton}\n                    onSubmit={this.submit}\n                    ref={ref => {\n                        this.componentRef = ref;\n                    }}\n                />\n            </Fragment>\n        ) : (\n            <PreAuthorizedDebitCanadaComponent\n                onChange={this.setState}\n                payButton={this.payButton}\n                showPayButton={this.props.showPayButton}\n                placeholders={this.props.placeholders}\n                setComponentRef={this.setComponentRef}\n                showContextualElement={this.props.showContextualElement}\n                enableStoreDetails={this.props.enableStoreDetails}\n            />\n        );\n    }\n}\n\nexport default PreAuthorizedDebitCanada;\n"],"names":["PreAuthorizedDebitCanada","UIElement","formatData","this","props","storedPaymentMethodId","paymentMethod","type","ownerName","state","data","bankAccountNumber","bankCode","bankLocationId","storePaymentMethod","formatProps","enableStoreDetails","session","configuration","isValid","displayName","lastFour","name","additionalInfo","label","componentToRender","h","Fragment","SettlementInfo","RedirectButton","showPayButton","icon","resources","getImage","imageFolder","payAmountLabel","i18n","amount","payButton","onSubmit","submit","ref","componentRef","PreAuthorizedDebitCanadaComponent","onChange","setState","placeholders","setComponentRef","showContextualElement","TxVariants","eft_directdebit_CA"],"mappings":"8bAUO,MAAMA,UAAiCC,EAG1BC,UAAAA,GAGZ,QAF2BC,KAAKC,MAAMC,sBAG3B,CACHC,cAAe,CACXC,KAAMP,EAAyBO,KAC/BF,sBAAuBF,KAAKC,MAAMC,wBAKvC,CACHC,cAAe,CACXC,KAAMP,EAAyBO,KAC/BC,UAAWL,KAAKM,MAAMC,KAAKF,UAC3BG,kBAAmBR,KAAKM,MAAMC,KAAKC,kBACnCC,SAAUT,KAAKM,MAAMC,KAAKE,SAC1BC,eAAgBV,KAAKM,MAAMC,KAAKG,mBAEhCV,KAAKM,MAAMK,oBAAsB,CAAEA,mBAAoBX,KAAKM,MAAMK,oBAE9E,CAEgBC,WAAAA,CAAYX,GACxB,MAAO,CACHY,mBAAoBZ,EAAMa,SAASC,eAAeF,oBAAsBZ,EAAMY,sBAC3EZ,EAEX,CAEA,WAAoBe,GAChB,QAAIhB,KAAKC,MAAMC,yBAINF,KAAKM,MAAMU,OACxB,CAEA,eAAoBC,GAChB,OAAIjB,KAAKC,MAAMC,uBAAyBF,KAAKC,MAAMiB,SACxC,QAAQlB,KAAKC,MAAMiB,WAGvBlB,KAAKC,MAAMkB,IACtB,CAEA,kBAAoBC,GAChB,OAAOpB,KAAKC,MAAMC,sBAAwBF,KAAKC,MAAMoB,MAAQ,EACjE,CAEmBC,iBAAAA,GACf,OAAOtB,KAAKC,MAAMC,sBACdqB,EAACC,EAAAA,KACGD,EAACE,EAAAA,MACDF,EAACG,EAAAA,CACGC,cAAe3B,KAAKC,MAAM0B,cAC1BC,KAAM5B,KAAK6B,WAAWC,SAAS,CAAEC,YAAa,eAAxC/B,CAAyD,cAC/DqB,MAAOW,EAAehC,KAAKC,MAAMgC,KAAMjC,KAAKC,MAAMiC,QAClDf,KAAMnB,KAAKiB,YACXkB,UAAWnC,KAAKmC,UAChBC,SAAUpC,KAAKqC,OACfC,IAAKA,IACDtC,KAAKuC,aAAeD,MAKhCf,EAACiB,EAAAA,CACGC,SAAUzC,KAAK0C,SACfP,UAAWnC,KAAKmC,UAChBR,cAAe3B,KAAKC,MAAM0B,cAC1BgB,aAAc3C,KAAKC,MAAM0C,aACzBC,gBAAiB5C,KAAK4C,gBACtBC,sBAAuB7C,KAAKC,MAAM4C,sBAClChC,mBAAoBb,KAAKC,MAAMY,oBAG3C,cAjFShB,IACKO,SAAO0C,EAAWC"}