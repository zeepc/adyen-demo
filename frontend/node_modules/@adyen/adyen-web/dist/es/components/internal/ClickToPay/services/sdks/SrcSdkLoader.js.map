{"version":3,"file":"SrcSdkLoader.js","sources":["../../../../../../../src/components/internal/ClickToPay/services/sdks/SrcSdkLoader.ts"],"sourcesContent":["import { ISrcInitiator } from './AbstractSrcInitiator';\nimport VisaSdk from './VisaSdk';\nimport MastercardSdk from './MastercardSdk';\nimport { CustomSdkConfiguration } from './types';\nimport AdyenCheckoutError from '../../../../../core/Errors/AdyenCheckoutError';\nimport { isFulfilled, isRejected } from '../../../../../utils/promise-util';\nimport type { IAnalytics } from '../../../../../core/Analytics/Analytics';\n\nconst sdkMap: Record<string, typeof VisaSdk | typeof MastercardSdk | null> = {\n    visa: VisaSdk,\n    mc: MastercardSdk,\n    default: null\n};\n\nconst getSchemeSdk = (scheme: string, environment: string, customConfig: CustomSdkConfiguration, analytics: IAnalytics): ISrcInitiator | null => {\n    const SchemeSdkClass = sdkMap[scheme] || sdkMap.default;\n    return SchemeSdkClass ? new SchemeSdkClass(environment, customConfig, analytics) : null;\n};\n\nexport interface ISrcSdkLoader {\n    load(environment: string, analytics: IAnalytics): Promise<ISrcInitiator[]>;\n    schemes: string[];\n}\n\nclass SrcSdkLoader implements ISrcSdkLoader {\n    public readonly schemes: string[];\n\n    private readonly customSdkConfiguration: CustomSdkConfiguration;\n\n    constructor(schemes: string[], { dpaLocale = 'en_US', dpaPresentationName = '' }) {\n        this.schemes = schemes;\n        this.customSdkConfiguration = { dpaLocale, dpaPresentationName };\n    }\n\n    public async load(environment: string, analytics: IAnalytics): Promise<ISrcInitiator[]> {\n        if (!this.schemes || this.schemes.length === 0) {\n            throw new AdyenCheckoutError('ERROR', 'ClickToPay -> SrcSdkLoader: There are no schemes set to be loaded');\n        }\n\n        return new Promise((resolve, reject) => {\n            const sdks: ISrcInitiator[] = this.schemes.map(scheme => getSchemeSdk(scheme, environment, this.customSdkConfiguration, analytics));\n            const loadScriptPromises = sdks.map(sdk => sdk.loadSdkScript());\n\n            void Promise.allSettled(loadScriptPromises).then(loadScriptResponses => {\n                if (loadScriptResponses.every(isRejected)) {\n                    reject(\n                        new AdyenCheckoutError('ERROR', `ClickToPay -> SrcSdkLoader # Unable to load network schemes: ${this.schemes.toString()}`)\n                    );\n                }\n\n                const sdksLoaded = sdks.filter((sdk, index) => isFulfilled(loadScriptResponses[index]));\n\n                resolve(sdksLoaded);\n            });\n        });\n    }\n}\n\nexport default SrcSdkLoader;\n"],"names":["sdkMap","visa","VisaSdk","mc","MastercardSdk","default","SrcSdkLoader","load","environment","analytics","this","schemes","length","AdyenCheckoutError","Promise","resolve","reject","sdks","map","scheme","customConfig","SchemeSdkClass","getSchemeSdk","customSdkConfiguration","loadScriptPromises","sdk","loadSdkScript","allSettled","then","loadScriptResponses","every","isRejected","toString","sdksLoaded","filter","index","isFulfilled","constructor","dpaLocale","dpaPresentationName","_define_property"],"mappings":"yUAQA,MAAMA,EAAuE,CACzEC,KAAMC,EACNC,GAAIC,EACJC,QAAS,MAab,MAAMC,EAUF,UAAaC,CAAKC,EAAqBC,GACnC,IAAKC,KAAKC,SAAmC,IAAxBD,KAAKC,QAAQC,OAC9B,MAAM,IAAIC,EAAmB,QAAS,qEAG1C,OAAO,IAAIC,QAAQ,CAACC,EAASC,KACzB,MAAMC,EAAwBP,KAAKC,QAAQO,IAAIC,GA1BtC,EAACA,EAAgBX,EAAqBY,EAAsCX,KAC7F,MAAMY,EAAiBrB,EAAOmB,IAAWnB,EAAOK,QAChD,OAAOgB,EAAiB,IAAIA,EAAeb,EAAaY,EAAcX,GAAa,MAwBlBa,CAAaH,EAAQX,EAAaE,KAAKa,uBAAwBd,IAClHe,EAAqBP,EAAKC,IAAIO,GAAOA,EAAIC,iBAE1CZ,QAAQa,WAAWH,GAAoBI,KAAKC,IACzCA,EAAoBC,MAAMC,IAC1Bf,EACI,IAAIH,EAAmB,QAAS,gEAAgEH,KAAKC,QAAQqB,eAIrH,MAAMC,EAAahB,EAAKiB,OAAO,CAACT,EAAKU,IAAUC,EAAYP,EAAoBM,KAE/EpB,EAAQkB,MAGpB,CA1BA,WAAAI,CAAY1B,GAAmB2B,UAAEA,EAAY,QAAOC,oBAAEA,EAAsB,KAJ5EC,EAAA9B,KAAgBC,kBAEhB6B,EAAA9B,KAAiBa,iCAGbb,KAAKC,QAAUA,EACfD,KAAKa,uBAAyB,CAAEe,YAAWC,sBAC/C"}