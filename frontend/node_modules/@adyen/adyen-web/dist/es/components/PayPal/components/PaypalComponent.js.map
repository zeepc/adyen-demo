{"version":3,"file":"PaypalComponent.js","sources":["../../../../../src/components/PayPal/components/PaypalComponent.tsx"],"sourcesContent":["import { h } from 'preact';\nimport { useState, useEffect, useCallback } from 'preact/hooks';\nimport PaypalButtons from './PaypalButtons';\nimport Spinner from '../../internal/Spinner';\nimport { getPaypalUrl } from '../utils/get-paypal-url';\nimport Script from '../../../utils/Script';\nimport AdyenCheckoutError from '../../../core/Errors/AdyenCheckoutError';\nimport type { PayPalComponentProps } from './types';\nimport useAnalytics from '../../../core/Analytics/useAnalytics';\n\nexport default function PaypalComponent({ onApprove, onCancel, onChange, onError, onSubmit, onScriptLoadFailure, ...props }: PayPalComponentProps) {\n    const [status, setStatus] = useState('pending');\n    const { analytics } = useAnalytics();\n\n    this.setStatus = setStatus;\n\n    const handleOnApprove = useCallback(\n        (data: any, actions: any) => {\n            setStatus('processing');\n            onApprove(data, actions);\n        },\n        [onApprove]\n    );\n\n    const handlePaypalLoad = () => {\n        setStatus('ready');\n    };\n\n    const handlePaypalLoadFailure = (error: AdyenCheckoutError) => {\n        onScriptLoadFailure(error);\n    };\n\n    useEffect(() => {\n        const src = getPaypalUrl(props);\n\n        const attributes = { ...(props.cspNonce && { nonce: props.cspNonce }) },\n            dataAttributes = { ...(props.cspNonce && { cspNonce: props.cspNonce }) };\n\n        const script = new Script({\n            src,\n            component: 'paypal',\n            attributes,\n            dataAttributes,\n            analytics\n        });\n\n        script.load().then(handlePaypalLoad).catch(handlePaypalLoadFailure);\n\n        return () => {\n            script.remove();\n        };\n    }, []);\n\n    if (status === 'pending') {\n        return (\n            <div className=\"adyen-checkout__paypal\" aria-live=\"polite\" aria-busy=\"true\">\n                <div className=\"adyen-checkout__paypal__status adyen-checkout__paypal__status--pending\" data-testid={'paypal-loader'}>\n                    <Spinner />\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"adyen-checkout__paypal\">\n            <PaypalButtons\n                {...props}\n                onCancel={onCancel}\n                onChange={onChange}\n                onError={onError}\n                onSubmit={onSubmit}\n                onApprove={handleOnApprove}\n                isProcessingPayment={status === 'processing'}\n                paypalRef={window.paypal}\n            />\n        </div>\n    );\n}\n"],"names":["PaypalComponent","onApprove","onCancel","onChange","onError","onSubmit","onScriptLoadFailure","props","status","setStatus","useState","analytics","useAnalytics","this","handleOnApprove","useCallback","data","actions","handlePaypalLoad","handlePaypalLoadFailure","error","useEffect","src","getPaypalUrl","attributes","cspNonce","nonce","dataAttributes","script","Script","component","load","then","catch","remove","h","div","className","aria-live","aria-busy","data-testid","Spinner","PaypalButtons","isProcessingPayment","paypalRef","window","paypal"],"mappings":"4ZAUe,SAASA,GAAgBC,UAAEA,EAASC,SAAEA,EAAQC,SAAEA,EAAQC,QAAEA,EAAOC,SAAEA,EAAQC,oBAAEA,KAAwBC,IAChH,MAAOC,EAAQC,GAAaC,EAAS,YAC/BC,UAAEA,GAAcC,IAEtBC,KAAKJ,UAAYA,EAEjB,MAAMK,EAAkBC,EACpB,CAACC,EAAWC,KACRR,EAAU,cACVR,EAAUe,EAAMC,IAEpB,CAAChB,IAGCiB,EAAmB,KACrBT,EAAU,UAGRU,EAA2BC,IAC7Bd,EAAoBc,IAwBxB,OArBAC,EAAU,KACN,MAAMC,EAAMC,EAAahB,GAEnBiB,EAAa,IAAMjB,EAAMkB,UAAY,CAAEC,MAAOnB,EAAMkB,WACtDE,EAAiB,IAAMpB,EAAMkB,UAAY,CAAEA,SAAUlB,EAAMkB,WAEzDG,EAAS,IAAIC,EAAO,CACtBP,MACAQ,UAAW,SACXN,aACAG,iBACAhB,cAKJ,OAFAiB,EAAOG,OAAOC,KAAKd,GAAkBe,MAAMd,GAEpC,KACHS,EAAOM,WAEZ,IAEY,YAAX1B,EAEI2B,EAACC,MAAAA,CAAIC,UAAU,yBAAyBC,YAAU,SAASC,YAAU,QACjEJ,EAACC,MAAAA,CAAIC,UAAU,yEAAyEG,cAAa,iBACjGL,EAACM,EAAAA,QAObN,EAACC,MAAAA,CAAIC,UAAU,0BACXF,EAACO,EAAAA,IACOnC,EACJL,SAAUA,EACVC,SAAUA,EACVC,QAASA,EACTC,SAAUA,EACVJ,UAAWa,EACX6B,oBAAgC,eAAXnC,EACrBoC,UAAWC,OAAOC,SAIlC"}