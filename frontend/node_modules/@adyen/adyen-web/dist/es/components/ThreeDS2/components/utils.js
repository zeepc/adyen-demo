import{CHALLENGE_WINDOW_SIZES as e,DEFAULT_CHALLENGE_WINDOW_SIZE as t}from"../constants.js";import{getOrigin as r}from"../../../utils/getOrigin.js";import s from"../../../utils/base64.js";const n=e=>"success"in e&&!e.success,a=e=>{const t=s.decode(e);if(t.success)try{return JSON.parse(t.data)}catch(e){return{success:!1,error:"Could not JSON parse token"}}return t},o=e=>{if(!e||!Object.keys(e).length)throw new Error("No (populated) data object to encode");return s.encode(JSON.stringify(e))},i=r=>{const s=1===r.length?`0${r}`:r;return Object.prototype.hasOwnProperty.call(e,s)?s:t},c=t=>e[i(t)],p=({token:e,size:t})=>{const s=a(e);if(n(s))return s;const{acsTransID:o,acsURL:p,messageVersion:l,threeDSNotificationURL:d,threeDSServerTransID:h}=s,u=r(d);return{acsURL:p,cReqData:{acsTransID:o,messageVersion:l,threeDSServerTransID:h,messageType:"CReq",challengeWindowSize:i(t)},iframeSizeArr:c(t),postMessageDomain:u}},l=({token:e,notificationURL:t})=>{const s=a(e);if(n(s))return s;const{threeDSMethodNotificationURL:o,threeDSMethodUrl:i,threeDSServerTransID:c}=s,p=t||o;return{threeDSServerTransID:c,threeDSMethodURL:i,threeDSMethodNotificationURL:p,postMessageDomain:r(p)}},d=(e,t,r)=>({data:{[e]:o({threeDSCompInd:t.threeDSCompInd}),paymentData:r}}),h=(e,t,r)=>({data:{details:{"threeds2.fingerprint":o(t)},paymentData:r}}),u=(e,t,r)=>({data:{details:{[e]:o({transStatus:t,authorisationToken:r})}}}),D=(e,t,r)=>({data:{details:{"threeds2.challengeResult":o({transStatus:t})},paymentData:r}}),m=e=>{let t=window.btoa(e).split("=")[0];return t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_"),t},S=(e,t)=>"fingerprint"===e?{showSpinner:!t.isDropin,statusType:"loading",...t.elementRef&&{elementRef:t.elementRef}}:{statusType:"custom",i18n:t.i18n,elementRef:t.elementRef};export{u as createChallengeResolveData,d as createFingerprintResolveData,D as createOldChallengeResolveData,h as createOldFingerprintResolveData,a as decodeAndParseToken,m as encodeBase64URL,o as encodeObject,S as get3DS2FlowProps,c as getChallengeWindowSize,n as isErrorObject,p as prepareChallengeData,l as prepareFingerPrintData,i as validateChallengeWindowSize};
//# sourceMappingURL=utils.js.map
