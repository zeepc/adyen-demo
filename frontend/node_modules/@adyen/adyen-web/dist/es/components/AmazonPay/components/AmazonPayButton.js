import{createElement as o}from"../../../external/preact/dist/preact.js";import{useState as t,useEffect as e}from"../../../external/preact/hooks/dist/hooks.js";import{getAmazonSignature as n}from"../services.js";import{getPayloadJSON as r,getAmazonPaySettings as a}from"../utils.js";import{useCoreContext as i}from"../../../core/Context/CoreProvider.js";import{useAmount as s}from"../../../core/Context/AmountProvider.js";function c(c){const{amount:u}=s(),{loadingContext:m}=i(),{amazonRef:l,configuration:f={}}=c,[h,p]=t(null),d=r(c,u),y=a(c,u),C=()=>{new Promise(c.onClick).then(this.initCheckout).catch(o=>{c.onError&&c.onError(o,this.componentRef)})};return this.initCheckout=()=>{const o={payloadJSON:JSON.stringify(d),publicKeyId:f.publicKeyId,signature:h};l.Pay.initCheckout({...y,createCheckoutSessionConfig:o})},e(()=>{const{clientKey:o}=c;n(m,o,d).then(o=>{if(!o?.signature)return console.error("Could not get AmazonPay signature");p(o.signature),c.showPayButton&&l.Pay.renderButton("#amazonPayButton",y).onClick(C)}).catch(o=>{console.error(o),c.onError&&c.onError(o,this.componentRef)})},[]),c.showPayButton?o("div",{className:"adyen-checkout__amazonpay__button",id:"amazonPayButton"}):null}export{c as default};
//# sourceMappingURL=AmazonPayButton.js.map
