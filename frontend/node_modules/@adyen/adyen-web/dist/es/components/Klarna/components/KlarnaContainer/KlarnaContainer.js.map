{"version":3,"file":"KlarnaContainer.js","sources":["../../../../../../src/components/Klarna/components/KlarnaContainer/KlarnaContainer.tsx"],"sourcesContent":["import { h } from 'preact';\nimport { useEffect, useRef, useState } from 'preact/hooks';\nimport { KlarnaWidget } from '../KlarnaWidget/KlarnaWidget';\nimport type { ComponentMethodsRef, UIElementStatus } from '../../../internal/UIElement/types';\nimport type { ActionHandledReturnObject } from '../../../../types/global-types';\nimport type { AdyenCheckoutError, KlarnaAction, KlarnaAdditionalDetailsData, KlarnaComponentRef } from '../../../../types';\nimport { PayButtonProps } from '../../../internal/PayButton/PayButton';\n\ninterface KlarnaContainerProps {\n    setComponentRef: (ref: ComponentMethodsRef) => void;\n    displayName: string;\n    showPayButton: boolean;\n    type: string;\n    onComplete(state: KlarnaAdditionalDetailsData): void;\n    onError(error: AdyenCheckoutError): void;\n    payButton(props: PayButtonProps): h.JSX.Element;\n    onLoaded(): void;\n    onActionHandled(actionHandled: ActionHandledReturnObject): void;\n}\n\nexport function KlarnaContainer({ setComponentRef, ...props }: KlarnaContainerProps) {\n    const [widgetInitializationTime, setWidgetInitializationTime] = useState<number>(null);\n    const [action, setAction] = useState<KlarnaAction>();\n    const [status, setStatus] = useState('ready');\n    const klarnaRef = useRef<KlarnaComponentRef>({\n        setAction: (action: KlarnaAction) => {\n            setAction(action);\n            setWidgetInitializationTime(new Date().getTime());\n        },\n        setStatus: (status: UIElementStatus) => setStatus(status),\n        reinitializeWidget: () => {\n            setWidgetInitializationTime(new Date().getTime());\n        }\n    });\n\n    useEffect(() => {\n        setComponentRef(klarnaRef.current);\n    }, [setComponentRef]);\n\n    if (action?.sdkData) {\n        return (\n            <KlarnaWidget\n                widgetInitializationTime={widgetInitializationTime}\n                sdkData={action.sdkData}\n                paymentMethodType={action.paymentMethodType}\n                paymentData={action.paymentData}\n                payButton={props.payButton}\n                onComplete={props.onComplete}\n                onError={props.onError}\n                onLoaded={() => {\n                    props.onActionHandled?.({ componentType: props.type, actionDescription: 'sdk-loaded', originalAction: action });\n                    props.onLoaded();\n                }}\n            />\n        );\n    }\n\n    if (props.showPayButton) {\n        return props.payButton({\n            ...props,\n            status,\n            disabled: status === 'loading',\n            classNameModifiers: ['standalone'],\n            label: `${this.props.i18n.get('continueTo')} ${props.displayName}`\n        });\n    }\n\n    return null;\n}\n"],"names":["KlarnaContainer","setComponentRef","props","widgetInitializationTime","setWidgetInitializationTime","useState","action","setAction","status","setStatus","klarnaRef","useRef","Date","getTime","reinitializeWidget","useEffect","current","sdkData","h","KlarnaWidget","paymentMethodType","paymentData","payButton","onComplete","onError","onLoaded","onActionHandled","componentType","type","actionDescription","originalAction","showPayButton","disabled","classNameModifiers","label","this","i18n","get","displayName"],"mappings":"gPAoBO,SAASA,GAAgBC,gBAAEA,KAAoBC,IAClD,MAAOC,EAA0BC,GAA+BC,EAAiB,OAC1EC,EAAQC,GAAaF,KACrBG,EAAQC,GAAaJ,EAAS,SAC/BK,EAAYC,EAA2B,CACzCJ,UAAYD,IACRC,EAAUD,GACVF,GAA4B,IAAIQ,MAAOC,YAE3CJ,UAAYD,GAA4BC,EAAUD,GAClDM,mBAAoB,KAChBV,GAA4B,IAAIQ,MAAOC,cAQ/C,OAJAE,EAAU,KACNd,EAAgBS,EAAUM,UAC3B,CAACf,IAEAK,GAAQW,QAEJC,EAACC,EAAAA,CACGhB,yBAA0BA,EAC1Bc,QAASX,EAAOW,QAChBG,kBAAmBd,EAAOc,kBAC1BC,YAAaf,EAAOe,YACpBC,UAAWpB,EAAMoB,UACjBC,WAAYrB,EAAMqB,WAClBC,QAAStB,EAAMsB,QACfC,SAAU,KACNvB,EAAMwB,kBAAkB,CAAEC,cAAezB,EAAM0B,KAAMC,kBAAmB,aAAcC,eAAgBxB,IACtGJ,EAAMuB,cAMlBvB,EAAM6B,cACC7B,EAAMoB,UAAU,IAChBpB,EACHM,SACAwB,SAAqB,YAAXxB,EACVyB,mBAAoB,CAAC,cACrBC,MAAO,GAAGC,KAAKjC,MAAMkC,KAAKC,IAAI,iBAAiBnC,EAAMoC,gBAItD,IACX"}