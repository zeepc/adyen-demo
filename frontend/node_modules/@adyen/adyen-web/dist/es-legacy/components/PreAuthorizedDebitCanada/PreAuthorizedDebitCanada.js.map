{"version":3,"file":"PreAuthorizedDebitCanada.js","sources":["../../../../src/components/PreAuthorizedDebitCanada/PreAuthorizedDebitCanada.tsx"],"sourcesContent":["import { h, Fragment } from 'preact';\nimport UIElement from '../internal/UIElement/UIElement';\nimport { TxVariants } from '../tx-variants';\nimport PreAuthorizedDebitCanadaComponent from './components/PreAuthorizedDebitCanadaComponent';\nimport { SettlementInfo } from './components/SettlementInfo';\nimport RedirectButton from '../internal/RedirectButton';\nimport { payAmountLabel } from '../internal/PayButton/utils';\n\nimport type { PreAuthorizedDebitCanadaConfiguration } from './types';\n\nexport class PreAuthorizedDebitCanada extends UIElement<PreAuthorizedDebitCanadaConfiguration> {\n    public static type = TxVariants.eft_directdebit_CA;\n\n    public override formatData() {\n        const recurringPayment = !!this.props.storedPaymentMethodId;\n\n        if (recurringPayment) {\n            return {\n                paymentMethod: {\n                    type: PreAuthorizedDebitCanada.type,\n                    storedPaymentMethodId: this.props.storedPaymentMethodId\n                }\n            };\n        }\n\n        return {\n            paymentMethod: {\n                type: PreAuthorizedDebitCanada.type,\n                ownerName: this.state.data.ownerName,\n                bankAccountNumber: this.state.data.bankAccountNumber,\n                bankCode: this.state.data.bankCode,\n                bankLocationId: this.state.data.bankLocationId\n            },\n            ...(this.state.storePaymentMethod && { storePaymentMethod: this.state.storePaymentMethod })\n        };\n    }\n\n    public override formatProps(props: PreAuthorizedDebitCanadaConfiguration): PreAuthorizedDebitCanadaConfiguration {\n        return {\n            enableStoreDetails: props.session?.configuration?.enableStoreDetails ?? props.enableStoreDetails,\n            ...props\n        };\n    }\n\n    public override get isValid(): boolean {\n        if (this.props.storedPaymentMethodId) {\n            return true;\n        }\n\n        return !!this.state.isValid;\n    }\n\n    public override get displayName(): string {\n        if (this.props.storedPaymentMethodId && this.props.lastFour) {\n            return `•••• ${this.props.lastFour}`;\n        }\n\n        return this.props.name;\n    }\n\n    public override get additionalInfo(): string {\n        return this.props.storedPaymentMethodId ? this.props.label : '';\n    }\n\n    protected override componentToRender(): h.JSX.Element {\n        return this.props.storedPaymentMethodId ? (\n            <Fragment>\n                <SettlementInfo />\n                <RedirectButton\n                    showPayButton={this.props.showPayButton}\n                    icon={this.resources?.getImage({ imageFolder: 'components/' })(`bento_lock`)}\n                    label={payAmountLabel(this.props.i18n, this.props.amount)}\n                    name={this.displayName}\n                    payButton={this.payButton}\n                    onSubmit={this.submit}\n                    ref={ref => {\n                        this.componentRef = ref;\n                    }}\n                />\n            </Fragment>\n        ) : (\n            <PreAuthorizedDebitCanadaComponent\n                onChange={this.setState}\n                payButton={this.payButton}\n                showPayButton={this.props.showPayButton}\n                placeholders={this.props.placeholders}\n                setComponentRef={this.setComponentRef}\n                showContextualElement={this.props.showContextualElement}\n                enableStoreDetails={this.props.enableStoreDetails}\n            />\n        );\n    }\n}\n\nexport default PreAuthorizedDebitCanada;\n"],"names":["PreAuthorizedDebitCanada","UIElement","formatData","this","props","storedPaymentMethodId","paymentMethod","type","_object_spread","ownerName","state","data","bankAccountNumber","bankCode","bankLocationId","storePaymentMethod","formatProps","enableStoreDetails","_ref","session","configuration","isValid","displayName","lastFour","name","additionalInfo","label","componentToRender","_this_resources","h","Fragment","SettlementInfo","RedirectButton","showPayButton","icon","resources","getImage","imageFolder","payAmountLabel","i18n","amount","payButton","onSubmit","submit","ref","componentRef","PreAuthorizedDebitCanadaComponent","onChange","setState","placeholders","setComponentRef","showContextualElement","_define_property","TxVariants","eft_directdebit_CA"],"mappings":"03BAUO,MAAMA,UAAiCC,EAG1BC,UAAAA,GAGZ,QAF2BC,KAAKC,MAAMC,sBAG3B,CACHC,cAAe,CACXC,KAAMP,EAAyBO,KAC/BF,sBAAuBF,KAAKC,MAAMC,wBAKvCG,EAAA,CACHF,cAAe,CACXC,KAAMP,EAAyBO,KAC/BE,UAAWN,KAAKO,MAAMC,KAAKF,UAC3BG,kBAAmBT,KAAKO,MAAMC,KAAKC,kBACnCC,SAAUV,KAAKO,MAAMC,KAAKE,SAC1BC,eAAgBX,KAAKO,MAAMC,KAAKG,iBAEhCX,KAAKO,MAAMK,oBAAsB,CAAEA,mBAAoBZ,KAAKO,MAAMK,oBAE9E,CAEgBC,WAAAA,CAAYZ,SAEAA,EAAAA,EADxB,OAAOI,EAAA,CACHS,mBAAoE,QAAlDC,UAAEd,EAAAA,EAAMe,eAANf,IAAAA,WAAAA,EAAAA,EAAegB,qBAAfhB,IAAAA,OAAAA,EAAAA,EAA8Ba,8BAAkBC,EAAAA,EAAId,EAAMa,oBAC3Eb,EAEX,CAEA,WAAoBiB,GAChB,QAAIlB,KAAKC,MAAMC,yBAINF,KAAKO,MAAMW,OACxB,CAEA,eAAoBC,GAChB,OAAInB,KAAKC,MAAMC,uBAAyBF,KAAKC,MAAMmB,SACxC,QAAQpB,KAAKC,MAAMmB,WAGvBpB,KAAKC,MAAMoB,IACtB,CAEA,kBAAoBC,GAChB,OAAOtB,KAAKC,MAAMC,sBAAwBF,KAAKC,MAAMsB,MAAQ,EACjE,CAEmBC,iBAAAA,GAMG,IAAAC,EALlB,OAAOzB,KAAKC,MAAMC,sBACdwB,EAACC,EAAAA,KACGD,EAACE,EAAAA,MACDF,EAACG,EAAAA,CACGC,cAAe9B,KAAKC,MAAM6B,cAC1BC,KAAoB,QAAdN,EAAAzB,KAAKgC,qBAALP,OAAA,EAAAA,EAAgBQ,SAAS,CAAEC,YAAa,eAAxCT,CAAyD,cAC/DF,MAAOY,EAAenC,KAAKC,MAAMmC,KAAMpC,KAAKC,MAAMoC,QAClDhB,KAAMrB,KAAKmB,YACXmB,UAAWtC,KAAKsC,UAChBC,SAAUvC,KAAKwC,OACfC,IAAKA,IACDzC,KAAK0C,aAAeD,MAKhCf,EAACiB,EAAAA,CACGC,SAAU5C,KAAK6C,SACfP,UAAWtC,KAAKsC,UAChBR,cAAe9B,KAAKC,MAAM6B,cAC1BgB,aAAc9C,KAAKC,MAAM6C,aACzBC,gBAAiB/C,KAAK+C,gBACtBC,sBAAuBhD,KAAKC,MAAM+C,sBAClClC,mBAAoBd,KAAKC,MAAMa,oBAG3C,EAhFAmC,EADSpD,EACKO,OAAO8C,EAAWC"}