{"version":3,"file":"PasskeySdkLoader.js","sources":["../../../../../src/components/PayByBankPix/services/PasskeySdkLoader.ts"],"sourcesContent":["import { IAdyenPasskey } from './types';\nimport { getUrlFromMap } from '../../../core/Environment/Environment';\nimport type { CoreConfiguration } from '../../../core/types';\nimport { CDN_ENVIRONMENTS } from '../../../core/Environment/constants';\nimport AdyenCheckoutError from '../../../core/Errors/AdyenCheckoutError';\nimport Script from '../../../utils/Script';\nimport { IAnalytics } from '../../../core/Analytics/Analytics';\n\nexport interface IPasskeySdkLoader {\n    load(environment: CoreConfiguration['environment'], analytics: IAnalytics): Promise<IAdyenPasskey>;\n}\n\nclass PasskeySdkLoader implements IPasskeySdkLoader {\n    private static readonly PASSKEY_SDK_URL = 'js/adyenpasskey/1.1.0/adyen-passkey.js';\n    private AdyenPasskey: IAdyenPasskey;\n\n    private readonly analytics: IAnalytics;\n    private readonly environment: string;\n\n    constructor({ analytics, environment }: { analytics: IAnalytics; environment: string }) {\n        this.analytics = analytics;\n        this.environment = environment;\n    }\n\n    private isAvailable(): boolean {\n        return this.AdyenPasskey != null;\n    }\n\n    public async load(): Promise<IAdyenPasskey> {\n        if (this.isAvailable()) {\n            return this.AdyenPasskey;\n        }\n\n        try {\n            const cdnUrl = getUrlFromMap(this.environment as CoreConfiguration['environment'], CDN_ENVIRONMENTS);\n            const url = `${cdnUrl}${PasskeySdkLoader.PASSKEY_SDK_URL}`;\n\n            const scriptElement = new Script({\n                src: url,\n                component: 'paybybank_pix',\n                analytics: this.analytics\n            });\n\n            await scriptElement.load();\n            this.AdyenPasskey = window.AdyenPasskey?.default;\n            return this.AdyenPasskey;\n        } catch (e: unknown) {\n            throw new AdyenCheckoutError(\n                'SCRIPT_ERROR',\n                `Unable to load script. Message: ${e instanceof Error ? e.message : 'Unknown error loading Passkey sdk'}`\n            );\n        }\n    }\n}\n\nexport { PasskeySdkLoader };\n"],"names":["PasskeySdkLoader","isAvailable","this","AdyenPasskey","load","window","cdnUrl","getUrlFromMap","environment","CDN_ENVIRONMENTS","scriptElement","Script","src","PASSKEY_SDK_URL","component","analytics","default","e","AdyenCheckoutError","Error","message","constructor","_define_property"],"mappings":"6WAYA,MAAMA,EAYMC,WAAAA,GACJ,OAA4B,MAArBC,KAAKC,YAChB,CAEA,UAAaC,GACT,GAAIF,KAAKD,cACL,OAAOC,KAAKC,aAGhB,IAWwBE,IAAAA,EAVpB,MAAMC,EAASC,EAAcL,KAAKM,YAAiDC,GAG7EC,EAAgB,IAAIC,EAAO,CAC7BC,IAHQ,GAAGN,IAASN,EAAiBa,kBAIrCC,UAAW,gBACXC,UAAWb,KAAKa,YAKpB,aAFML,EAAcN,OACpBF,KAAKC,aAAkC,QAAnBE,EAAAA,OAAOF,oBAAPE,IAAAA,OAAAA,EAAAA,EAAqBW,QAClCd,KAAKC,YAChB,CAAE,MAAOc,GACL,MAAM,IAAIC,EACN,eACA,mCAAmCD,aAAaE,MAAQF,EAAEG,QAAU,sCAE5E,CACJ,CAjCA,WAAAC,EAAYN,UAAEA,EAASP,YAAEA,IALzBc,EAAApB,KAAQC,uBAERmB,EAAApB,KAAiBa,oBACjBO,EAAApB,KAAiBM,sBAGbN,KAAKa,UAAYA,EACjBb,KAAKM,YAAcA,CACvB,EATAc,EADEtB,EACsBa,kBAAkB"}