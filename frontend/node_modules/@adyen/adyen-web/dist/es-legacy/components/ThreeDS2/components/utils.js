import{CHALLENGE_WINDOW_SIZES as e,DEFAULT_CHALLENGE_WINDOW_SIZE as t}from"../constants.js";import{getOrigin as r}from"../../../utils/getOrigin.js";import n from"../../../utils/base64.js";function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const s=e=>"success"in e&&!e.success,a=e=>{const t=n.decode(e);if(t.success)try{return JSON.parse(t.data)}catch(e){return{success:!1,error:"Could not JSON parse token"}}return t},i=e=>{if(!e||!Object.keys(e).length)throw new Error("No (populated) data object to encode");return n.encode(JSON.stringify(e))},c=r=>{const n=1===r.length?`0${r}`:r;return Object.prototype.hasOwnProperty.call(e,n)?n:t},l=t=>e[c(t)],u=({token:e,size:t})=>{const n=a(e);if(s(n))return n;const{acsTransID:o,acsURL:i,messageVersion:u,threeDSNotificationURL:p,threeDSServerTransID:f}=n,h=r(p);return{acsURL:i,cReqData:{acsTransID:o,messageVersion:u,threeDSServerTransID:f,messageType:"CReq",challengeWindowSize:c(t)},iframeSizeArr:l(t),postMessageDomain:h}},p=({token:e,notificationURL:t})=>{const n=a(e);if(s(n))return n;const{threeDSMethodNotificationURL:o,threeDSMethodUrl:i,threeDSServerTransID:c}=n,l=t||o;return{threeDSServerTransID:c,threeDSMethodURL:i,threeDSMethodNotificationURL:l,postMessageDomain:r(l)}},f=(e,t,r)=>({data:{[e]:i({threeDSCompInd:t.threeDSCompInd}),paymentData:r}}),h=(e,t,r)=>({data:{details:{"threeds2.fingerprint":i(t)},paymentData:r}}),d=(e,t,r)=>({data:{details:{[e]:i({transStatus:t,authorisationToken:r})}}}),m=(e,t,r)=>({data:{details:{"threeds2.challengeResult":i({transStatus:t})},paymentData:r}}),D=e=>{let t=window.btoa(e).split("=")[0];return t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_"),t},S=(e,t)=>"fingerprint"===e?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){o(e,t,r[t])})}return e}({showSpinner:!t.isDropin,statusType:"loading"},t.elementRef&&{elementRef:t.elementRef}):{statusType:"custom",i18n:t.i18n,elementRef:t.elementRef};export{d as createChallengeResolveData,f as createFingerprintResolveData,m as createOldChallengeResolveData,h as createOldFingerprintResolveData,a as decodeAndParseToken,D as encodeBase64URL,i as encodeObject,S as get3DS2FlowProps,l as getChallengeWindowSize,s as isErrorObject,u as prepareChallengeData,p as prepareFingerPrintData,c as validateChallengeWindowSize};
//# sourceMappingURL=utils.js.map
