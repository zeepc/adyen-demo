import{createElement as t}from"../../../external/preact/dist/preact.js";import{useState as e,useEffect as o}from"../../../external/preact/hooks/dist/hooks.js";import{getAmazonSignature as r}from"../services.js";import{getPayloadJSON as n,getAmazonPaySettings as c}from"../utils.js";import{useCoreContext as i}from"../../../core/Context/CoreProvider.js";import{useAmount as a}from"../../../core/Context/AmountProvider.js";function s(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function u(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e.push.apply(e,o)}return e}(Object(e)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}),t}function l(l){const{amount:f}=a(),{loadingContext:p}=i(),{amazonRef:y,configuration:m={}}=l,[b,O]=e(null),h=n(l,f),P=c(l,f),j=()=>{new Promise(l.onClick).then(this.initCheckout).catch(t=>{l.onError&&l.onError(t,this.componentRef)})};return this.initCheckout=()=>{const t={payloadJSON:JSON.stringify(h),publicKeyId:m.publicKeyId,signature:b};y.Pay.initCheckout(u(function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{},r=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),r.forEach(function(e){s(t,e,o[e])})}return t}({},P),{createCheckoutSessionConfig:t}))},o(()=>{const{clientKey:t}=l;r(p,t,h).then(t=>{if(!(null==t?void 0:t.signature))return console.error("Could not get AmazonPay signature");O(t.signature),l.showPayButton&&y.Pay.renderButton("#amazonPayButton",P).onClick(j)}).catch(t=>{console.error(t),l.onError&&l.onError(t,this.componentRef)})},[]),l.showPayButton?t("div",{className:"adyen-checkout__amazonpay__button",id:"amazonPayButton"}):null}export{l as default};
//# sourceMappingURL=AmazonPayButton.js.map
